# ğŸš€ RAFT Enhanced v4 - Quick Start Guide

**ç›®æ ‡ï¼šç”Ÿæˆé«˜è´¨é‡é—®ç­”å¯¹ç”¨äºåŠå¯¼ä½“æ˜¾ç¤ºé¢†åŸŸçš„RAGæ¨¡å‹è®­ç»ƒ**

## ğŸ“‹ å‰ç½®è¦æ±‚

### 1. ç¯å¢ƒå‡†å¤‡
```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt
pip install matplotlib seaborn pandas

# è®¾ç½®ç¯å¢ƒå˜é‡
export CHUNK_NUM=4
export CHUNK_NUM_MIN=2  
export NUM_distract=3
export PROMPT_KEY="deepseek-v2"
export COMPLETION_MODEL="deepseek-r1-250120"
export COMPLETION_OPENAI_BASE_URL="your_api_base_url"
export COMPLETION_OPENAI_API_KEY="your_api_key"
```

### 2. æ•°æ®å‡†å¤‡
å°†ä½ çš„æ–‡æ¡£æ”¾å…¥ `data/` ç›®å½•ï¼š
```
data/
â”œâ”€â”€ document1.md
â”œâ”€â”€ document2.md
â””â”€â”€ document3.md
```

## âš¡ ä¸‰ç§è¿è¡Œæ¨¡å¼

### ğŸ”¥ æ¨¡å¼1ï¼šå®Œæ•´å¢å¼ºç®¡é“ï¼ˆæ¨èï¼‰
**é€‚ç”¨åœºæ™¯**ï¼šç”Ÿäº§ç¯å¢ƒï¼Œè¿½æ±‚æœ€é«˜è´¨é‡

```bash
# ä¸€é”®è¿è¡Œæ‰€æœ‰æ¨¡å¼
bash utils/syndata_pipeline_v4.sh

# æˆ–æ‰‹åŠ¨è¿è¡Œå®Œæ•´å¢å¼ºç‰ˆ
python -m utils.syndata_pipeline_v4 \
  --data_dir "data" \
  --syndatas_path "outputs_enhanced/syndatas/syndatas_enhanced.json" \
  --start_idx 0 \
  --end_idx 10
```

**ç‰¹ç‚¹**ï¼š
- âœ… æ–‡æ¡£è´¨é‡é¢„ç­›é€‰
- âœ… å¢å¼ºç‰ˆé—®é¢˜ç”Ÿæˆ
- âœ… é—®é¢˜è´¨é‡éªŒè¯
- â±ï¸ é€Ÿåº¦è¾ƒæ…¢ï¼Œè´¨é‡æœ€é«˜

### âš¡ æ¨¡å¼2ï¼šå¿«é€Ÿæ¨¡å¼
**é€‚ç”¨åœºæ™¯**ï¼šå¼€å‘æµ‹è¯•ï¼Œå¹³è¡¡é€Ÿåº¦å’Œè´¨é‡

```bash
python -m utils.syndata_pipeline_v4 \
  --data_dir "data" \
  --skip_document_filter \
  --syndatas_path "outputs_enhanced/syndatas/syndatas_fast.json" \
  --start_idx 0 \
  --end_idx 10
```

**ç‰¹ç‚¹**ï¼š
- âŒ è·³è¿‡æ–‡æ¡£ç­›é€‰
- âœ… å¢å¼ºç‰ˆé—®é¢˜ç”Ÿæˆ  
- âœ… é—®é¢˜è´¨é‡éªŒè¯
- âš¡ é€Ÿåº¦ä¸­ç­‰ï¼Œè´¨é‡è¾ƒé«˜

### ğŸ”„ æ¨¡å¼3ï¼šå…¼å®¹æ¨¡å¼
**é€‚ç”¨åœºæ™¯**ï¼šä¸v3ç‰ˆæœ¬å¯¹æ¯”ï¼Œå¿«é€Ÿè¿­ä»£

```bash
python -m utils.syndata_pipeline_v4 \
  --data_dir "data" \
  --skip_document_filter \
  --skip_question_validation \
  --syndatas_path "outputs_enhanced/syndatas/syndatas_compat.json" \
  --start_idx 0 \
  --end_idx 10
```

**ç‰¹ç‚¹**ï¼š
- âŒ è·³è¿‡æ–‡æ¡£ç­›é€‰
- âŒ è·³è¿‡é—®é¢˜éªŒè¯
- âš¡ é€Ÿåº¦æœ€å¿«ï¼Œæ ‡å‡†è´¨é‡

## ğŸ“Š è´¨é‡è¯„ä¼°

### å•ä¸ªæ•°æ®é›†è¯„ä¼°
```bash
python enhanced_quality_evaluation.py \
  --input outputs_enhanced/syndatas/syndatas_enhanced.json
```

### å¤šæ•°æ®é›†å¯¹æ¯”
```bash
python enhanced_quality_evaluation.py --compare \
  outputs_enhanced/syndatas/syndatas_enhanced.json \
  outputs_enhanced/syndatas/syndatas_fast.json \
  outputs_enhanced/syndatas/syndatas_compat.json
```

### å¤§æ•°æ®é›†é‡‡æ ·è¯„ä¼°
```bash
python enhanced_quality_evaluation.py \
  --input your_large_dataset.json \
  --sample_size 100
```

## ğŸ¯ å…³é”®å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| `--start_idx` | æ–‡æ¡£èµ·å§‹ç´¢å¼• | 0 |
| `--end_idx` | æ–‡æ¡£ç»“æŸç´¢å¼• | æ ¹æ®æ–‡æ¡£æ•°é‡è®¾å®š |
| `--max_workers` | å¹¶å‘æ•°é‡ | 4-8 |
| `--skip_document_filter` | è·³è¿‡æ–‡æ¡£ç­›é€‰ | å¼€å‘æ—¶ä½¿ç”¨ |
| `--skip_question_validation` | è·³è¿‡é—®é¢˜éªŒè¯ | ä»…å…¼å®¹æ¨¡å¼ä½¿ç”¨ |

## ğŸ“ˆ è´¨é‡æŒ‡æ ‡è§£è¯»

### è¯„ä¼°ç»´åº¦
1. **æ€ç»´é“¾é€»è¾‘è´¨é‡** (35%æƒé‡)ï¼šæ¨ç†æ­¥éª¤å®Œæ•´æ€§å’Œè¿è´¯æ€§
2. **æŠ€æœ¯å‡†ç¡®åº¦** (30%æƒé‡)ï¼šææ–™ç‰¹æ€§å’Œåˆ¶ç¨‹å‚æ•°å‡†ç¡®æ€§  
3. **é¢†åŸŸæ·±åº¦** (20%æƒé‡)ï¼šç¼ºé™·æœºç†å’ŒæŠ€æœ¯è¶‹åŠ¿è¦†ç›–
4. **åº”ç”¨ä»·å€¼** (15%æƒé‡)ï¼šå·¥ç¨‹å¯è¡Œæ€§å’Œæˆæœ¬ä¼˜åŒ–

### è´¨é‡ç­‰çº§
- **High**: é«˜è´¨é‡é—®ç­”å¯¹ï¼Œå¯ç›´æ¥ç”¨äºè®­ç»ƒ
- **Medium**: ä¸­ç­‰è´¨é‡ï¼Œå¯èƒ½éœ€è¦å°‘é‡äººå·¥å®¡æ ¸
- **Low**: ä½è´¨é‡ï¼Œå»ºè®®é‡æ–°ç”Ÿæˆæˆ–ä¸¢å¼ƒ

## ğŸ”§ å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: è¾“å‡ºæ–‡ä»¶ä¸ºç©º
**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ `start_idx` å’Œ `end_idx` èŒƒå›´æ˜¯å¦æ­£ç¡®
```bash
# æŸ¥çœ‹æ–‡æ¡£æ•°é‡
ls -la data/*.md | wc -l

# ç›¸åº”è°ƒæ•´ç´¢å¼•èŒƒå›´
--start_idx 0 --end_idx å®é™…æ–‡æ¡£æ•°é‡
```

### Q2: APIè°ƒç”¨å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®è®¤ç¯å¢ƒå˜é‡è®¾ç½®æ­£ç¡®
```bash
echo $COMPLETION_OPENAI_BASE_URL
echo $COMPLETION_OPENAI_API_KEY
```

### Q3: è´¨é‡è¯„åˆ†åä½
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥åŸå§‹æ–‡æ¡£è´¨é‡
2. ä½¿ç”¨å®Œæ•´å¢å¼ºç®¡é“
3. è°ƒæ•´promptæ¨¡æ¿è®¾ç½®

### Q4: å†…å­˜ä¸è¶³
**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å‡å°‘ `--max_workers` æ•°é‡
2. åˆ†æ‰¹å¤„ç†æ–‡æ¡£ï¼ˆè°ƒæ•´ `end_idx`ï¼‰
3. å¢åŠ ç³»ç»Ÿå†…å­˜

## ğŸ“ è¾“å‡ºæ–‡ä»¶è¯´æ˜

```
outputs_enhanced/
â”œâ”€â”€ chunks/                    # æ–‡æ¡£åˆ†å—ç»“æœ
â”œâ”€â”€ chunk4/                   # ç»„åˆå—ç»“æœ  
â”œâ”€â”€ topics/                   # ä¸»é¢˜æå–ç»“æœ
â”œâ”€â”€ questions/                # åŸå§‹é—®é¢˜
â”œâ”€â”€ validated_questions/      # éªŒè¯åé—®é¢˜
â”œâ”€â”€ answers/                  # ç­”æ¡ˆç”Ÿæˆç»“æœ
â””â”€â”€ syndatas/                 # æœ€ç»ˆè®­ç»ƒæ•°æ®
    â”œâ”€â”€ syndatas_enhanced.json    # å®Œæ•´å¢å¼ºç‰ˆ
    â”œâ”€â”€ syndatas_fast.json        # å¿«é€Ÿæ¨¡å¼
    â””â”€â”€ syndatas_compat.json      # å…¼å®¹æ¨¡å¼
```

## ğŸ¨ æœ€ä½³å®è·µ

### ç”Ÿäº§ç¯å¢ƒ
1. ä½¿ç”¨**å®Œæ•´å¢å¼ºç®¡é“**
2. è®¾ç½®åˆé€‚çš„æ–‡æ¡£èŒƒå›´
3. å®šæœŸç›‘æ§è´¨é‡æŒ‡æ ‡
4. ä¿å­˜è¯„ä¼°æŠ¥å‘Šå¤‡æŸ¥

### å¼€å‘æµ‹è¯•
1. ä½¿ç”¨**å¿«é€Ÿæ¨¡å¼**
2. å°èŒƒå›´æµ‹è¯•ï¼ˆ`end_idx=5`ï¼‰
3. å¯¹æ¯”ä¸åŒæ¨¡å¼æ•ˆæœ
4. é€æ­¥æ‰©å¤§å¤„ç†èŒƒå›´

### å¤§è§„æ¨¡å¤„ç†
1. åˆ†æ‰¹å¤„ç†æ–‡æ¡£
2. å¢åŠ å¹¶å‘æ•°é‡
3. ä½¿ç”¨é‡‡æ ·è¯„ä¼°
4. ç›‘æ§ç³»ç»Ÿèµ„æºä½¿ç”¨

## ğŸ”— ä¸‹ä¸€æ­¥

1. **æ¨¡å‹è®­ç»ƒ**ï¼šä½¿ç”¨ç”Ÿæˆçš„æ•°æ®è®­ç»ƒRAGæ¨¡å‹
2. **æ•ˆæœè¯„ä¼°**ï¼šåœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šæµ‹è¯•æ¨¡å‹æ€§èƒ½
3. **è¿­ä»£ä¼˜åŒ–**ï¼šæ ¹æ®æ•ˆæœè°ƒæ•´å‚æ•°å’Œprompt
4. **è§„æ¨¡æ‰©å±•**ï¼šå¤„ç†æ›´å¤§è§„æ¨¡çš„æ–‡æ¡£é›†åˆ

---

ğŸ’¡ **æç¤º**ï¼šå»ºè®®å…ˆç”¨å°‘é‡æ–‡æ¡£æµ‹è¯•æ•´ä¸ªæµç¨‹ï¼Œç¡®è®¤æ•ˆæœåå†è¿›è¡Œå¤§è§„æ¨¡å¤„ç†ã€‚

ğŸ“ **æ”¯æŒ**ï¼šé‡åˆ°é—®é¢˜å¯æŸ¥çœ‹è¯¦ç»†æ—¥å¿—æˆ–æ£€æŸ¥ `evaluation_results/` ç›®å½•ä¸‹çš„è´¨é‡æŠ¥å‘Šã€‚